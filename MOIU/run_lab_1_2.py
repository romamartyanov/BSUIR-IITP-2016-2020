from numpy import array

from lab_1_2.lib import simplex


def test1():
    A = array([
        [0.0, 1.0, 4.0, 1.0, 0.0, -8.0, 1.0, 5.0],
        [0.0, -1.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0.0],
        [0.0, 2.0, -1.0, 0.0, -1.0, 3.0, -1.0, 0.0],
        [1.0, 1.0, 1.0, 1.0, 0.0, 3.0, 1.0, 1.0]
    ])
    b = array([36.0, -11.0, 10.0, 20.0])
    c = array([-5.0, 2.0, 3.0, -4.0, -6.0, 0.0, 1.0, -5.0])
    x_0 = array([4.0, 5.0, 0.0, 6.0, 0.0, 0.0, 0.0, 5.0])
    Jb = array([1, 2, 4, 8])
    correct_result = ([0.0, 9.5, 5.333, 1.5, 0.0, 0.0, 3.667, 0.0], 32.6667)

    simplex(A, c, x_0, Jb)
    print('Correct answer: ', correct_result)


def test2():
    A = array([
        [0.0, 1.0, 1.0, 1.0, 0.0, -8.0, 1.0, 5.0],
        [0.0, -1.0, 0.0, -7.5, 0.0, 0.0, 0.0, 2.0],
        [0.0, 2.0, 1.0, 0.0, -1.0, 3.0, -1.4, 0.0],
        [1.0, 1.0, 1.0, 1.0, 0.0, 3.0, 1.0, 1.0]
    ])
    b = array([15.0, -45.0, 1.8, 19.0])
    c = array([-6.0, -9.0, -5.0, 2.0, -6.0, 0.0, 1.0, 3.0])
    x_0 = array([4.0, 0.0, 6.0, 6.0, 0.0, 0.0, 3.0, 0.0])
    Jb = array([1, 3, 4, 7])
    correct_result = ([0.0, 0.0, 0.0, 7.055, 0.0, 1.803, 2.578, 3.958], 28.5628)

    simplex(A, c, x_0, Jb)
    print('Correct answer: ', correct_result)


def test3():
    A = array([
        [0.0, -1.0, 1.0, -7.5, 0.0, 0.0, 0.0, 2.0],
        [0.0, 2.0, 1.0, 0.0, -1.0, 3.0, -1.5, 0.0],
        [1.0, -1.0, 1.0, -1.0, 0.0, 3.0, 1.0, 1.0]
    ])
    b = array([6.0, 1.5, 10.0])
    c = array([-6.0, -9.0, -5.0, 2.0, -6.0, 0.0, 1.0, 3.0])
    x_0 = array([4.0, 0.0, 6.0, 0.0, 4.5, 0.0, 0.0, 0.0])
    Jb = array([1, 3, 5])
    correct_result = ([0.0, 0.75, 0.0, 2.682, 0.0, 0.0, 0.0, 13.432], 38.9091)

    simplex(A, c, x_0, Jb)
    print('Correct answer: ', correct_result)

#
# def testx():
#     A = array([
#         [0.0, 1.0, 4.0, 1.0, 0.0, -3.0, 1.0, 5.0],
#         [0.0, -1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
#         [0.0, 7.0, -1.0, 0.0, -1.0, 3.0, -1.0, 0.0],
#         [1.0, 1.0, 1.0, 1.0, 0.0, 3.0, -1.0, 1.0]
#     ])
#     b = array([15.0, -45.0, 1.8, 19.0])
#     c = array([-5.0, -2.0, 3.0, -4.0, -6.0, 0.0, 1.0, -5.0])
#     x_0 = array([10.0, 0.0, 1.5, 0.0, 0.5, 0.0, 0.0, 3.5])
#     Jb = array([1, 4, 5, 8])
#     correct_result = "Целевая функция неограничена сверху!"
#     assert correct_result == lab1.simplex(A, c, x_0, Jb)


def test4():
    A = array([
        [2.0, -1.0, 1.0, -7.5, 0.0, 0.0, 0.0, 2.0],
        [4.0, 2.0, -1.0, 0.0, 1.0, 2.0, -1.0, -4.0],
        [1.0, -1.0, 1.0, -1.0, 0.0, 3.0, 1.0, 1.0]
    ])
    b = array([14.0, 14.0, 10.0])
    c = array([-6.0, -9.0, -5.0, 2.0, -6.0, 0.0, 1.0, 3.0])
    x_0 = array([4.0, 0.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0])
    Jb = array([1, 3, 5])
    correct_result = ([4.625, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 2.375], -20.6250)

    simplex(A, c, x_0, Jb)
    print('Correct answer: ', correct_result)


def test5():
    A = array([
        [-2.0, -1.0, 3.0, -7.5, 0.0, 0.0, 0.0, 2.0],
        [4.0, 2.0, -6.0, 0.0, 1.0, 5.0, -1.0, -4.0],
        [1.0, -1.0, 0.0, -1.0, 0.0, 3.0, 1.0, 1.0]
    ])
    b = array([-23.5, -24.0, 2.0])
    c = array([-6.0, 9.0, -5.0, 2.0, -6.0, 0.0, 1.0, 3.0])
    x_0 = array([0.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 7.0])
    Jb = array([4, 5, 8])
    correct_result = "Целевая функция неограничена сверху!"

    simplex(A, c, x_0, Jb)
    print('Correct answer: ', correct_result)


def test6():
    A = array([
        [-2.0, -1.0, 1.0, -7.0, 0.0, 0.0, 0.0, 2.0],
        [4.0, 2.0, -1.0, 0.0, 1.0, 5.0, -1.0, -5.0],
        [1.0, 11.0, 0.0, 1.0, 0.0, 3.0, 1.0, 1.0]
    ])
    b = array([-2.0, 14.0, 4.0])
    c = array([-6.0, -9.0, 5.0, -2.0, 6.0, 0.0, -1.0, 3.0])
    x_0 = array([4.0, 0.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0])
    Jb = array([1, 2, 3])
    correct_result = ([0.0, 0.0, 26.0, 4.0, 40.0, 0.0, 0.0, 0.0], 362)

    simplex(A, c, x_0, Jb)
    print('Correct answer: ', correct_result)


if __name__ == "__main__":
    test1()
    input()

    test2()
    input()

    test3()
    input()

    test4()
    input()

    test5()
    input()

    test6()
